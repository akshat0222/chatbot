
 <!-- Chatbot widget code -->
  <style>
    /* Chat bubble button */
    #chatbot-button {
      position: fixed;
      bottom: 70px;
      right: 30px;
      width: 60px;
      height: 60px;
      background-color: #007bff;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      color: white;
      font-size: 30px;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10000;
    }

    /* Chat window */
    #chatbot-container {
      position: fixed;
      bottom: 100px;
      right: 30px;
      width: 360px;
      height: 500px;
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      display: none;
      flex-direction: column;
      overflow: hidden;
      z-index: 10000;
    }
    #chatbot-container.active{display:flex;}

    #chat-messages {
      flex: 1;
      padding: 10px;
      overflow-y: auto;
      font-size: 14px;
    }

    .message {
      margin: 8px 0;
    }

    .user {
      color: rgb(0, 0, 0);
    }

    .bot {
      color: rgb(0, 0, 0);
    }

    #chat-input {
      display: flex;
      border-top: 1px solid #ccc;
    }

    #chat-input input {
      flex: 1;
      padding: 10px;
      border: none;
      font-size: 14px;
    }

    #chat-input button {
      padding: 10px;
      background-color: #007bff;
      border: none;
      color: white;
      cursor: pointer;
    }
    .close-chat {
    border: none;
    position: absolute;
    right: 15px;
    top: 13px;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #0d6efd;
    color: #fff;
    border-radius: 30px;
}
.footer-links button{color:#fff;text-transform:capitalize;text-decoration:none;border:none;border-right:2px solid #ddd;padding-inline:10px;background:none;}
.footer-links button:first-child{padding-left:0;}
.footer-links button:last-child{border-right:none;padding-right:0;}
  </style>



<!-- Chat bubble button -->
<div id="chatbot-button">ðŸ’¬</div>

<!-- Chat window -->
<div id="chatbot-container">
  <button class="close-chat"><i class="fa-solid fa-xmark"></i></button>
  <div id="chat-messages"></div>
  <div id="chat-input">
    <input type="text" id="user-input" placeholder="Type a message..." />
    <button id="send-button">Send</button>
  </div>
</div>

<script>
  const chatbotButton = document.getElementById('chatbot-button');
  const chatbotContainer = document.getElementById('chatbot-container');
  const chatMessages = document.getElementById('chat-messages');
  const userInput = document.getElementById('user-input');
  const sendButton = document.getElementById('send-button');

  chatbotButton.addEventListener('click', () => {
    chatbotContainer.classList.toggle('active');
  });

  sendButton.addEventListener('click', sendMessage);
  userInput.addEventListener('keypress', function (e) {
    if (e.key === 'Enter') sendMessage();
  });

  function appendMessage(text, sender) {
    const div = document.createElement('div');
    div.classList.add('message', sender);
    div.innerText = `${sender === 'user' ? 'You' : 'LeadBot'}: ${text}`;
    chatMessages.appendChild(div);
    chatMessages.scrollTop = chatMessages.scrollHeight;
  }

  async function sendMessage() {
    const message = userInput.value.trim();
    if (!message) return;

    appendMessage(message, 'user');
    userInput.value = '';

    try {
      const res = await fetch('http://10.10.11.218:5500/chat', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ user_query: message })
      });

      const data = await res.json();

      if (res.ok) {
        const reply = formatBotReply(data);
        if (reply.type === 'html') {
            appendHtmlMessage(reply.content);
          } else {
            appendMessage(reply.content, 'bot');
          }
      } else {
        appendMessage(data.error || 'Error from bot', 'bot');
      }
    } catch (err) {
      appendMessage('Server not reachable.', 'bot');
    }
  }
function formatBotReply(data) {
  if (data.html_result) {
    return { type: 'html', content: data.html_result };
  }

  let reply = '';
  if (data.generated_sql) {
    reply += `SQL: ${data.generated_sql}\n`;
  }

  if (data.results && Array.isArray(data.results)) {
    if (data.results.length === 0) {
      reply += 'No results found.';
    } else {
      reply += 'Results:\n';
      data.results.slice(0, 3).forEach(row => {
        reply += JSON.stringify(row) + '\n';
      });
    }
  }

  return { type: 'text', content: reply.trim() };
}

  $('.close-chat').on('click', function () {
  $(this).parent().removeClass('active');
});
  $(document).on('click', function (e) {
  // If the click is NOT inside the chatbot container or the button
  if (!$(e.target).closest('#chatbot-container, #chatbot-button').length) {
    $('#chatbot-container').removeClass('active');
  }
});

function appendHtmlMessage(htmlContent) {
  const div = document.createElement('div');
  div.classList.add('message', 'bot');
  div.innerHTML = `<strong>LeadBot:</strong><br>${htmlContent}`;
  chatMessages.appendChild(div);
  chatMessages.scrollTop = chatMessages.scrollHeight;
}


</script>
<footer class="site-footer bg-dark text-center text-white p-3">
    <div class="container-fluid d-flex align-items-center justify-content-between">
  <p class="m-0">Â© {{ "2025" }} Autmation. All rights reserved to art fertility clinics</p>
  <div class="footer-links">
  <a href="/support">support </a>
  <button type="button" data-bs-toggle="modal" data-bs-target="#myModal">feedback </button>
  </div>
  
  </div>

</footer>

<!-- javascript for currenet year  -->

<!-- The Modal -->
<div class="modal" id="myModal">
<div class="modal-dialog modal-dialog-centered">
<div class="modal-content">
<!-- Modal Header -->
<div class="modal-header">
<h4 class="modal-title">Modal Heading</h4>
<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
</div>
<!-- Modal Body -->
<div class="modal-body">
Modal body
</div>
<!-- Modal Footer -->
<div class="modal-footer">
<button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>
